<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Universidad Mayor de San Andrés- Análisis Numérico (Práctico)</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="topbar">
    <h1>Universidad Mayor de San Andrés — Análisis Numérico Práctico</h1>
    <p class="subtitle">Facultad de Ciencias Puras y Naturales —  Ejemplos por carrera</p>
  </header>

  <main class="container">
    <section class="hero-problematica">
      <div class="hero-texto">
        <h2>PROBLEMÁTICA GENERAL</h2>
        <p>
          La Universidad Mayor de San Andrés busca optimizar la asignación de su presupuesto anual basado en las proyecciones de matrícula estudiantil por carrera.
          Para ello, se requiere determinar el punto de equilibrio financiero, ajustar modelos de regresión a los datos históricos de matrícula y finalmente distribuir
          el presupuesto disponible de manera proporcional o mediante la resolución de un sistema de ecuaciones.
        </p>
      </div>

    </section>

    <!-- Tabs: pasos del proyecto -->
    <div class="tabs" id="main-tabs">
      <div class="tab-header">
        <button class="tab-btn active" data-tab="tab-1">1) Punto de equilibrio</button>
        <button class="tab-btn" data-tab="tab-2">2) Ajuste de datos</button>
        <button class="tab-btn" data-tab="tab-3">3) Asignación presupuesto</button>
      </div>

      <div class="tab-content-wrap">
      <section id="tab-1" class="tab-content active card">
        <h2>1) Punto de equilibrio (Bisección / Newton-Raphson)</h2>
      <p>
        El punto de equilibrio se define como el nivel de matrícula en el cual los ingresos totales igualan los costos totales.
        Se modela la función de ingresos y costos en función del número de estudiantes matriculados, y se busca la raíz de la función
        que representa la diferencia entre ingresos y costos utilizando los métodos numéricos de Bisección y Newton-Raphson.
      </p>
      <h6>La formulautilizada es : f(x) = Ingresos(x) - Costos(x)</h6>

      <div class="form-row">
        <label>Carrera</label>
        <select id="career-select">
          {% for c in careers %}
            <option value="{{ c }}">{{ c }}</option>
          {% endfor %}
        </select>
        <label>Matrícula (Bs)</label>
        <input id="price" type="number" value="350" />
        <label>Fijo F (Bs)</label>
        <input id="fixed" type="number" value="40000" />
        <label>Variable V (Bs)</label>
        <input id="var" type="number" value="120" />
      </div>

      <div class="form-row">
        <label>Intervalo bisección [a,b]</label>
        <input id="bisection-a" type="number" value="1" />
        <input id="bisection-b" type="number" value="1000" />
        <button id="run-bisection" class="btn primary">Ejecutar Bisección</button>
        <button id="run-newton" class="btn accent">Ejecutar Newton</button>
        <select id="compare-methods">
          <option value="none">-- Comparar ambos --</option>
          <option value="both">Ambos (Bisección vs Newton)</option>
        </select>
      </div>

      <div id="eq-result" class="result"></div>
      <div class="grid-two">
        <div>
          <h4>Tabla de iteraciones</h4>
          <div id="iter-table"></div>
        </div>
        <div>
          <h4>Gráfico de error por iteración</h4>
          <canvas id="error-chart" width="400" height="240"></canvas>
        </div>
      </div>
      <div id="eq-conclusion" class="result muted"></div>
      <div class="form-row">
        <button class="btn" id="to-tab-2">Siguiente: Ajuste de datos →</button>
      </div>
    </section>
    <section id="tab-2" class="tab-content card">
      <h2>2) Ajuste de datos (Regresión)</h2>
      <div class="form-row">
        <label>Carrera</label>
        <select id="reg-career">
          {% for c in careers %}
            <option value="{{ c }}">{{ c }}</option>
          {% endfor %}
        </select>
        <label>Modelo</label>
        <select id="reg-model">
          <option value="linear">Lineal</option>
          <option value="poly2">Polinómica grado 2</option>
        </select>
        <label>Año a predecir</label>
        <input id="next-year" type="number" value="{{ years[-1] + 1 }}" />
        <button id="run-reg" class="btn primary">Ajustar y predecir</button>
      </div>

      <div id="reg-result" class="result"></div>
      <div class="grid-two">
        <div>
          <h4>Datos (históricos)</h4>
          <pre id="reg-data"></pre>
        </div>
        <div>
          <h4>Gráfico de ajuste</h4>
          <canvas id="reg-chart" width="400" height="240"></canvas>
        </div>
      </div>
      <div id="reg-conclusion" class="result muted"></div>
      <div class="form-row">
        <button class="btn" id="to-tab-3">Siguiente: Asignación →</button>
        <button class="btn" id="back-to-tab-1">← Volver: Punto de equilibrio</button>
      </div>
    </section>
    <section id="tab-3" class="tab-content card">
      <h2>3) Asignación de presupuesto (Sistemas / Proporcional)</h2>
      <div class="form-row">
        <label>Matrícula (Bs)</label>
        <input id="budget-price" type="number" value="350" />
        <button id="use-predictions" class="btn">Cargar predicciones de ejemplo</button>
      </div>

      <div id="proj-inputs" class="proj-grid">
        {% for c in careers %}
          <div class="proj-item">
            <label>{{ c }}</label>
            <input class="proj-val" data-career="{{ c }}" type="number" value="{{ sample.data[c].students[-1] }}" />
          </div>
        {% endfor %}
      </div>

      <div class="form-row">
        <button id="run-budget" class="btn primary">Calcular asignación proporcional</button>
        <button id="run-system" class="btn accent">Resolver sistema (Gauss / Gauss-Seidel)</button>
        <select id="system-method">
          <option value="gauss">Gauss (directo)</option>
          <option value="gs">Gauss-Seidel (iterativo)</option>
        </select>
      </div>

      <div id="budget-result" class="result"></div>
      <div id="system-table"></div>
      <div id="system-conclusion" class="result muted"></div>
      <div class="form-row">
        <button class="btn" id="back-to-tab-2">← Volver: Ajuste de datos</button>
      </div>
    </section>
    </div> <!-- /tab-content-wrap -->
    </div> <!-- /tabs -->

    <footer class="card small muted">
      <p>Proyecto por Sara.</p>
    </footer>
  </main>

  <script>const SAMPLE = {{ sample|tojson }};</script>
  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
